<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>2. Workspace | Robin Firth</title>
<meta name="keywords" content="" />
<meta name="description" content="Before working gradually through Vulkan, we will assume we want to implement a reusable wrapper library for Vulkan, since Ash itself is very unsafe, and we don&rsquo;t really want to write unsafe code everywhere. We can have a proper separation of library and executable packages and allow for their own dependencies by using Cargo workspaces.
Root At the root of the package will be a Cargo.toml file describing the workspace. The way Cargo handles workspaces is that at this workspace level we simply need to name the members of the workspace.">
<meta name="author" content="">
<link rel="canonical" href="https://forgottenmaster.github.io/posts/vulkan/lets-learn-vulkan/workspace/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.6f60056d44d3f7eb69a4bc6c332b59960f3a995802bded244750232f33713c49.css" integrity="sha256-b2AFbUTT9&#43;tppLxsMytZlg86mVgCve0kR1AjLzNxPEk=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js" integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5&#43;kdJvBz5iKbt6B5PJI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://forgottenmaster.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://forgottenmaster.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://forgottenmaster.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://forgottenmaster.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://forgottenmaster.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.92.2" />
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><meta property="og:title" content="2. Workspace" />
<meta property="og:description" content="Before working gradually through Vulkan, we will assume we want to implement a reusable wrapper library for Vulkan, since Ash itself is very unsafe, and we don&rsquo;t really want to write unsafe code everywhere. We can have a proper separation of library and executable packages and allow for their own dependencies by using Cargo workspaces.
Root At the root of the package will be a Cargo.toml file describing the workspace. The way Cargo handles workspaces is that at this workspace level we simply need to name the members of the workspace." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://forgottenmaster.github.io/posts/vulkan/lets-learn-vulkan/workspace/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-13T23:31:03&#43;00:00" />
<meta property="article:modified_time" content="2023-02-13T23:31:03&#43;00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="2. Workspace"/>
<meta name="twitter:description" content="Before working gradually through Vulkan, we will assume we want to implement a reusable wrapper library for Vulkan, since Ash itself is very unsafe, and we don&rsquo;t really want to write unsafe code everywhere. We can have a proper separation of library and executable packages and allow for their own dependencies by using Cargo workspaces.
Root At the root of the package will be a Cargo.toml file describing the workspace. The way Cargo handles workspaces is that at this workspace level we simply need to name the members of the workspace."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://forgottenmaster.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Vulkan",
      "item": "https://forgottenmaster.github.io/posts/vulkan/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Let's Learn Vulkan",
      "item": "https://forgottenmaster.github.io/posts/vulkan/lets-learn-vulkan/"
    }, 
    {
      "@type": "ListItem",
      "position":  4 ,
      "name": "2. Workspace",
      "item": "https://forgottenmaster.github.io/posts/vulkan/lets-learn-vulkan/workspace/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "2. Workspace",
  "name": "2. Workspace",
  "description": "Before working gradually through Vulkan, we will assume we want to implement a reusable wrapper library for Vulkan, since Ash itself is very unsafe, and we don\u0026rsquo;t really want to write unsafe code everywhere. We can have a proper separation of library and executable packages and allow for their own dependencies by using Cargo workspaces.\nRoot At the root of the package will be a Cargo.toml file describing the workspace. The way Cargo handles workspaces is that at this workspace level we simply need to name the members of the workspace.",
  "keywords": [
    
  ],
  "articleBody": "Before working gradually through Vulkan, we will assume we want to implement a reusable wrapper library for Vulkan, since Ash itself is very unsafe, and we don’t really want to write unsafe code everywhere. We can have a proper separation of library and executable packages and allow for their own dependencies by using Cargo workspaces.\nRoot At the root of the package will be a Cargo.toml file describing the workspace. The way Cargo handles workspaces is that at this workspace level we simply need to name the members of the workspace. These will be independant packages that are located as children of the workspace root.\nFor this project we only need 2 packages - one for our wrapper library (which we’ll call wrapper), and one binary package using the wrapper containing our working examples (which we’ll call examples).\nThe Cargo.toml file at the workspace root therefore looks as follows:\n[workspace] members = [\"wrapper\", \"examples\"] Wrapper This is the package that will contain the library crate, so most of the dependencies will be here. The only dependency that’s not required for the library package will be the winit crate because the specifics of the window that was created isn’t required due to the raw-window-handle crate we’re using.\nThe Cargo.toml file for the wrapper crate will be as follows:\n[package] name = \"lets-learn-vulkan-wrapper\" version = \"0.1.0\" edition = \"2021\" [dependencies] ash = { version = \"0.37.2\", default-features=false } anyhow = \"1.0.68\" raw-window-handle = \"0.5.0\" ash-window = \"0.12.0\" [features] default = [\"loaded\"] linked = [\"ash/linked\"] loaded = [\"ash/loaded\"] A brief explanation of the sections is:\n package - This section contains the metadata relating to the package itself such as the name, version, and which Rust edition we’re using. We will be taking the latest Rust edition as should all new projects. dependencies - This section lists the dependencies we want to use. We will turn off the default features of the Ash crate and propagate them to our own features. features - We define a couple of Cargo features to act as stand-ins for Ash’s linked and loaded features, and specify loaded as a default feature for ourself. This allows users of our crate to be able to choose either loaded or linked feature without having to deal with Ash directly as that should be a hidden dependency.  As a further, brief note on features, we have defined 3 features for our crate which can be summarised here:\n default - This feature is actually a meta-feature of sorts. It’s not a feature in it’s own right but lists the features that Cargo will enable by default unless the user turns off defaults. Here we list “loaded” as the default feature, which mimics what Ash does. linked - This feature represents us wanting to statically link Vulkan into the library. We enable the linked feature of Ash when we enable this. Requires the Vulkan SDK to be installed when building binaries. loaded - This feature represents using Vulkan as a dynamically loaded library which is default. Enables the loaded feature of Ash when enabled. Doesn’t require the Vulkan SDK on build machine, but is fallible on the target machine and will fail if it can’t load Vulkan for some reason.  Examples The examples crate is even simpler though, the Cargo.toml file looks as follows:\n[package] name = \"lets-learn-vulkan-examples\" version = \"0.1.0\" edition = \"2021\" [dependencies] winit = \"0.27.5\" The window creation will be handled on the binary side, and we use the raw-window-handle crate to bridge the gap.\n",
  "wordCount" : "584",
  "inLanguage": "en",
  "datePublished": "2023-02-13T23:31:03Z",
  "dateModified": "2023-02-13T23:31:03Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://forgottenmaster.github.io/posts/vulkan/lets-learn-vulkan/workspace/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Robin Firth",
    "logo": {
      "@type": "ImageObject",
      "url": "https://forgottenmaster.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://forgottenmaster.github.io/" accesskey="h" title="Robin Firth (Alt + H)">Robin Firth</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://forgottenmaster.github.io/resume/" title="Résumé">
                    <span>Résumé</span>
                </a>
            </li>
            <li>
                <a href="https://forgottenmaster.github.io/posts/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="https://forgottenmaster.github.io/archives/" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://forgottenmaster.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://forgottenmaster.github.io/posts/">Posts</a>&nbsp;»&nbsp;<a href="https://forgottenmaster.github.io/posts/vulkan/">Vulkan</a>&nbsp;»&nbsp;<a href="https://forgottenmaster.github.io/posts/vulkan/lets-learn-vulkan/">Let&#39;s Learn Vulkan</a></div>
    <h1 class="post-title">
      2. Workspace
    </h1>
    <div class="post-meta"><span title='2023-02-13 23:31:03 +0000 UTC'>February 13, 2023</span>&nbsp;·&nbsp;3 min

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#root" aria-label="Root">Root</a></li>
                <li>
                    <a href="#wrapper" aria-label="Wrapper">Wrapper</a></li>
                <li>
                    <a href="#examples" aria-label="Examples">Examples</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>Before working gradually through Vulkan, we will assume we want to implement a reusable wrapper library for Vulkan, since Ash itself is very unsafe, and we don&rsquo;t really want to write unsafe code everywhere. We can have a proper separation of library and executable packages and allow for their own dependencies by using <strong>Cargo workspaces</strong>.</p>
<h1 id="root">Root<a hidden class="anchor" aria-hidden="true" href="#root">#</a></h1>
<p>At the root of the package will be a Cargo.toml file describing the workspace. The way Cargo handles workspaces is that at this workspace level we simply need to name the members of the workspace. These will be independant packages that are located as children of the workspace root.</p>
<p>For this project we only need 2 packages - one for our wrapper library (which we&rsquo;ll call <strong>wrapper</strong>), and one binary package using the wrapper containing our working examples (which we&rsquo;ll call <strong>examples</strong>).</p>
<p>The Cargo.toml file at the workspace root therefore looks as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-toml" data-lang="toml">[<span style="color:#a6e22e">workspace</span>]
<span style="color:#a6e22e">members</span> = [<span style="color:#e6db74">&#34;wrapper&#34;</span>, <span style="color:#e6db74">&#34;examples&#34;</span>]</code></pre></div>
<h1 id="wrapper">Wrapper<a hidden class="anchor" aria-hidden="true" href="#wrapper">#</a></h1>
<p>This is the package that will contain the library crate, so most of the dependencies will be here. The only dependency that&rsquo;s not required for the library package will be the winit crate because the specifics of the window that was created isn&rsquo;t required due to the raw-window-handle crate we&rsquo;re using.</p>
<p>The Cargo.toml file for the wrapper crate will be as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-toml" data-lang="toml">[<span style="color:#a6e22e">package</span>]
<span style="color:#a6e22e">name</span> = <span style="color:#e6db74">&#34;lets-learn-vulkan-wrapper&#34;</span>
<span style="color:#a6e22e">version</span> = <span style="color:#e6db74">&#34;0.1.0&#34;</span>
<span style="color:#a6e22e">edition</span> = <span style="color:#e6db74">&#34;2021&#34;</span>

[<span style="color:#a6e22e">dependencies</span>]
<span style="color:#a6e22e">ash</span> = { <span style="color:#a6e22e">version</span> = <span style="color:#e6db74">&#34;0.37.2&#34;</span>, <span style="color:#a6e22e">default-features</span>=<span style="color:#66d9ef">false</span> }
<span style="color:#a6e22e">anyhow</span> = <span style="color:#e6db74">&#34;1.0.68&#34;</span>
<span style="color:#a6e22e">raw-window-handle</span> = <span style="color:#e6db74">&#34;0.5.0&#34;</span>
<span style="color:#a6e22e">ash-window</span> = <span style="color:#e6db74">&#34;0.12.0&#34;</span>

[<span style="color:#a6e22e">features</span>]
<span style="color:#a6e22e">default</span> = [<span style="color:#e6db74">&#34;loaded&#34;</span>]
<span style="color:#a6e22e">linked</span> = [<span style="color:#e6db74">&#34;ash/linked&#34;</span>]
<span style="color:#a6e22e">loaded</span> = [<span style="color:#e6db74">&#34;ash/loaded&#34;</span>]</code></pre></div>
<p>A brief explanation of the sections is:</p>
<ol>
<li><strong>package</strong> - This section contains the metadata relating to the package itself such as the name, version, and which Rust edition we&rsquo;re using. We will be taking the latest Rust edition as should all new projects.</li>
<li><strong>dependencies</strong> - This section lists the dependencies we want to use. We will turn off the default features of the Ash crate and propagate them to our own features.</li>
<li><strong>features</strong> - We define a couple of Cargo features to act as stand-ins for Ash&rsquo;s linked and loaded features, and specify loaded as a default feature for ourself. This allows users of our crate to be able to choose either loaded or linked feature without having to deal with Ash directly as that should be a hidden dependency.</li>
</ol>
<p>As a further, brief note on features, we have defined 3 features for our crate which can be summarised here:</p>
<ol>
<li><strong>default</strong> - This feature is actually a meta-feature of sorts. It&rsquo;s not a feature in it&rsquo;s own right but lists the features that Cargo will enable by default unless the user turns off defaults. Here we list &ldquo;loaded&rdquo; as the default feature, which mimics what Ash does.</li>
<li><strong>linked</strong> - This feature represents us wanting to statically link Vulkan into the library. We enable the linked feature of Ash when we enable this. Requires the Vulkan SDK to be installed when building binaries.</li>
<li><strong>loaded</strong> - This feature represents using Vulkan as a dynamically loaded library which is default. Enables the loaded feature of Ash when enabled. Doesn&rsquo;t require the Vulkan SDK on build machine, but is fallible on the target machine and will fail if it can&rsquo;t load Vulkan for some reason.</li>
</ol>
<h1 id="examples">Examples<a hidden class="anchor" aria-hidden="true" href="#examples">#</a></h1>
<p>The examples crate is even simpler though, the Cargo.toml file looks as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-toml" data-lang="toml">[<span style="color:#a6e22e">package</span>]
<span style="color:#a6e22e">name</span> = <span style="color:#e6db74">&#34;lets-learn-vulkan-examples&#34;</span>
<span style="color:#a6e22e">version</span> = <span style="color:#e6db74">&#34;0.1.0&#34;</span>
<span style="color:#a6e22e">edition</span> = <span style="color:#e6db74">&#34;2021&#34;</span>

[<span style="color:#a6e22e">dependencies</span>]
<span style="color:#a6e22e">winit</span> = <span style="color:#e6db74">&#34;0.27.5&#34;</span></code></pre></div>
<p>The window creation will be handled on the binary side, and we use the raw-window-handle crate to bridge the gap.</p>


  </div>

  <footer class="post-footer">
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://forgottenmaster.github.io/">Robin Firth</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
